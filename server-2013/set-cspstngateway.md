---
title: Set-CsPstnGateway
TOCTitle: Set-CsPstnGateway
ms:assetid: 5d61e7e5-dacb-4dd3-bdd5-b757d98181d3
ms:mtpsurl: https://technet.microsoft.com/en-us/library/Gg398408(v=OCS.15)
ms:contentKeyID: 48184283
ms.date: 07/23/2014
mtps_version: v=OCS.15
---

<div data-xmlns="http://www.w3.org/1999/xhtml">

<div class="topic" data-xmlns="http://www.w3.org/1999/xhtml" data-msxsl="urn:schemas-microsoft-com:xslt" data-cs="http://msdn.microsoft.com/en-us/">

<div data-asp="http://msdn2.microsoft.com/asp">

# Set-CsPstnGateway

</div>

<div id="mainSection">

<div id="mainBody">

<span> </span>

_**Topic Last Modified:** 2013-03-07_

Modifies the properties of a public switched telephone network (PSTN) gateway. PSTN gateways help route calls between devices on the external PSTN network and devices on your internal Enterprise Voice network. This cmdlet was introduced in Lync Server 2010.

<div>

## Syntax

    Set-CsPstnGateway [-Identity <XdsGlobalRelativeIdentity>] [-AlternateByPassId <String>] [-Confirm [<SwitchParameter>]] [-Default <$true | $false>] [-Force <SwitchParameter>] [-GatewaySipClientTcpPort <UInt16>] [-GatewaySipClientTlsPort <UInt16>] [-MediationServer <String>] [-RepresentativeMediaIP <String>] [-Routable <$true | $false>] [-WhatIf [<SwitchParameter>]]

</div>

<div>

## Examples

<div>

## EXAMPLE 1

The command shown in Example 1 configures the gateway PstnGateway:192.168.0.240 to be the default gateway. That means that PstnGateway:192.168.0.240 can be used to handle calls originating from Office Communications Server 2007 R2.

    Set-CsPstnGateway -Identity "PstnGateway:192.168.0.240" -Default $True

</div>

<div>

## EXAMPLE 2

Example 2 configures all the PSTN gateways in the organization, ensuring that each of these gateways can be used in outbound routing. To do this, the command first uses the **Get-CsService** cmdlet and the PstnGateway parameter to return a collection of all the PSTN gateways currently in use. This collection is then piped to the **ForEach-Object** cmdlet. The **ForEach-Object** cmdlet runs the **Set-CsPstnGateway** cmdlet against each gateway in the collection, setting the Routable property of each one to True.

    Get-CsService -PstnGateway | ForEach-Object {Set-CsPstnGateway -Identity $_.Identity -Routable $True}

</div>

</div>

<div>

## Detailed Description

PSTN gateways enable your Enterprise Voice users to make phone calls to, and receive phone calls from, people on the PSTN network. These gateways act as a bridge between the Mediation Server and the PSTN network.

PSTN gateways are typically required when you are using a Time Division Multiplex Public Branch Exchange (PBX) phone system; in that case, you will typically need to employ both a PSTN gateway and a Mediation Server in order to route Enterprise Voice calls to the PSTN network. By contrast, if you are using an IP-PBX system you can create a direct SIP connection between the PBX and the Mediation Server, eliminating the need for a PSTN gateway.

After your PSTN gateways have been installed and configured, they can be managed by using the **Set-CsPstnGateway** cmdlet.

Who can run this cmdlet: By default, members of the following groups are authorized to run the **Set-CsPstnGateway** cmdlet locally: RTCUniversalServerAdmins. To return a list of all the role-based access control (RBAC) roles this cmdlet has been assigned to (including any custom RBAC roles you have created yourself), run the following command from the Windows PowerShell prompt:

Get-CsAdminRole | Where-Object {$\_.Cmdlets –match "Set-CsPstnGateway"}

</div>

<div>

## Parameters


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><em>AlternateByPassId</em></p></td>
<td><p>Optional</p></td>
<td><p>System.String</p></td>
<td><p>Globally unique identifier (GUID) representing the alternate bypass ID. This ID is automatically generated by Lync Server and is used to help eliminate hairpin calls. Depending on the way you have configured your system, this allows hairpin calls to automatically bypass the Mediation Server without you having to define and associate individual subnets with all your sites and regions.</p>
<p>To do this, you typically need to globally enable bypass to use network configuration sites and regions, then enable bypass on the trunk configuration for your PSTN gateway.</p>
<p>A hairpin call occurs when an inbound call from the PSTN network is routed back to that network through call forwarding or simultaneous ringing.</p></td>
</tr>
<tr class="even">
<td><p><em>Confirm</em></p></td>
<td><p>Optional</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Prompts you for confirmation before executing the command.</p></td>
</tr>
<tr class="odd">
<td><p><em>Default</em></p></td>
<td><p>Optional</p></td>
<td><p>System.Boolean</p></td>
<td><p>If set to True, this gateway will handle calls sent from Office Communications Server 2007 R2. There can only be one default gateway in the collection of gateways managed by a single Mediation Server.</p></td>
</tr>
<tr class="even">
<td><p><em>Force</em></p></td>
<td><p>Optional</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Suppresses any confirmation prompts or non-fatal error messages that might occur when you run the cmdlet.</p></td>
</tr>
<tr class="odd">
<td><p><em>GatewaySipClientTcpPort</em></p></td>
<td><p>Optional</p></td>
<td><p>System.UInt16</p></td>
<td><p>Listening port used for communicating with Mediation Servers by using Transmission Control Protocol (TCP). The default value is 5066.</p></td>
</tr>
<tr class="even">
<td><p><em>GatewaySipClientTlsPort</em></p></td>
<td><p>Optional</p></td>
<td><p>System.UInt16</p></td>
<td><p>Listening port used for communicating with Mediation Servers by using the Transport Layer Security (TLS) protocol. The default value is 5067.</p></td>
</tr>
<tr class="odd">
<td><p><em>Identity</em></p></td>
<td><p>Optional</p></td>
<td><p>Microsoft.Rtc.Management.Xds.XdsGlobalRelativeIdentity</p></td>
<td><p>Service identity of the PSTN gateway to be modified. For example: -Identity &quot;PstnGateway:192.168.0.240&quot;.</p>
<p>Note that you can leave off the prefix &quot;PstnGatewayServer:&quot; when specifying a PSTN gateway. For example: -Identity &quot;atl-cs-001.litwareinc.com&quot;.</p></td>
</tr>
<tr class="even">
<td><p><em>MediationServer</em></p></td>
<td><p>Optional</p></td>
<td><p>System.String</p></td>
<td><p>Service identity of the Mediation Server to be associated with the PSTN gateway. For example: -MediationServer &quot;MediationServer:atl-cs-001.litwareinc.com&quot;.</p></td>
</tr>
<tr class="odd">
<td><p><em>RepresentativeMediaIP</em></p></td>
<td><p>Optional</p></td>
<td><p>System.String</p></td>
<td><p>IP address of the media processor associated with the gateway, provided that the processor location is different from the signaling address. Both media bypass and call admission control (CAC) are based on the location of the gateway’s media processor; by default, this is the same location as the signaling address. If the two locations differ (for example, with the media processor in a remote site and the signaling peer in the central site) then RepresentativeMediaIP must be configured with the IP address of the media processor.</p>
<p>If you have deployed multiple media processors in the same site, each with its own IP addresses, then you can use any of these IP addresses when configuring the RepresentativeMediaIP property.</p></td>
</tr>
<tr class="even">
<td><p><em>Routable</em></p></td>
<td><p>Optional</p></td>
<td><p>System.Boolean</p></td>
<td><p>If set to True, the gateway can be used in outbound routing routes.</p></td>
</tr>
<tr class="odd">
<td><p><em>WhatIf</em></p></td>
<td><p>Optional</p></td>
<td><p>System.Management.Automation.SwitchParameter</p></td>
<td><p>Describes what would happen if you executed the command without actually executing the command.</p></td>
</tr>
</tbody>
</table>


</div>

<div>

## Input Types

None. The **Get-CsPstnGateway** cmdlet does not accept pipelined input.

</div>

<div>

## Return Types

The **Set-CsPstnGateway** cmdlet does not return any objects or values. Instead, the cmdlet modifies existing instances of the Microsoft.Rtc.Management.Xds.DisplayPstnGateway object.

</div>

<div>

## See Also


[Get-CsService](get-csservice.md)  
  

</div>

</div>

<span> </span>

</div>

</div>

</div>

